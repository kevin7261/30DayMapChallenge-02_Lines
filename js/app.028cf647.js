(function(){"use strict";var e={7061:function(e,t,n){var o=n(5130),a=n(657),r=n(6768);const i={id:"app",class:"d-flex flex-column vh-100"},l={class:"d-flex flex-column overflow-hidden"};function s(e,t,n,o,a,s){const c=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("div",l,[(0,r.bF)(c)])])}var c={name:"App",components:{},setup(){return{}}},u=n(1241);const d=(0,u.A)(c,[["render",s]]);var m=d,f=n(1387),p=n(4232);const y={id:"app",class:"d-flex flex-column vh-100"},v={class:"flex-grow-1 overflow-hidden position-relative"},g={class:"position-absolute",style:{top:"50%",left:"0",transform:"translateY(-50%)","z-index":"1000",padding:"1rem"}},b={class:"bg-dark bg-opacity-75 rounded-3 p-3"},h={class:"mb-3"},C={class:"d-flex flex-column gap-1"},L=["onClick"];function w(e,t,n,o,a,i){const l=(0,r.g2)("MapTab");return(0,r.uX)(),(0,r.CE)("div",y,[(0,r.Lk)("div",v,[(0,r.bF)(l,{onMapReady:o.setMapInstance,"current-city":o.currentCity},null,8,["onMapReady","current-city"]),(0,r.Lk)("div",g,[(0,r.Lk)("div",b,[(0,r.Lk)("div",h,[(0,r.Lk)("div",C,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.cities,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e.layerId,class:(0,p.C4)(["btn border-0 my-city-btn my-font-sm-white px-4 py-3",[o.currentCity===e.layerName?"active":""]]),onClick:t=>o.navigateToCity(e.layerId)},(0,p.v_)(e.layerName),11,L)))),128))])])])])])])}n(8111),n(116);const I={id:"map-container",class:"h-100 w-100 position-relative bg-transparent z-0"},x=["id"];function z(e,t,n,o,a,i){return(0,r.uX)(),(0,r.CE)("div",I,[(0,r.Lk)("div",{id:o.mapContainerId,ref:"mapContainer",class:"h-100 w-100"},null,8,x)])}n(7588),n(1701);var k=n(144),E=n(6886),R=n.n(E);n(4114);const M=(0,a.nY)("data",(()=>{const e=(0,k.KR)([{groupName:"世界城市",groupLayers:[{layerId:"Xian",layerName:"XI'AN",zoom:12,coordinates:[[108.94187642402278,34.192881967113934],[108.94258912558922,34.34966320467116]]},{layerId:"Beijing",layerName:"BEIJING",zoom:11,coordinates:[[116.39637957256002,39.80351256231435],[116.38618671648146,40.012091717672405]]},{layerId:"Rome",layerName:"ROME",zoom:14,coordinates:[[12.467227004214806,41.93300140114903],[12.483219652625365,41.89425990038757]]},{layerId:"Paris",layerName:"PARIS",zoom:13,coordinates:[[2.33334539087744,48.86160021235486],[2.2188966642140713,48.89782995675384]]},{layerId:"Washington",layerName:"WASHINGTON",zoom:13,coordinates:[[-77.05013839452597,38.88929463507836],[-76.9133749343309,38.88976503523864]]},{layerId:"Berlin",layerName:"BERLIN",zoom:13,coordinates:[[13.229711365656641,52.50673639566284],[13.399053707740194,52.51765971170866]]}]}]),t=t=>{for(const n of e.value)for(const e of n.groupLayers)if(e.layerId===t)return e;return null},n=()=>{const t=[];for(const n of e.value)t.push(...n.groupLayers);return t},o=(0,k.KR)(null),a=e=>{o.value=e},i=(0,k.KR)(null),l=e=>{i.value=e},s=e=>{const n=t(e);if(!n)return;if(!i.value)return void setTimeout((()=>{i.value&&s(e)}),1e3);let o=null;const a=n.zoom||11;if(n.coordinates&&n.coordinates.length>=2){const[e,t]=n.coordinates[0],[a,r]=n.coordinates[1],i=(e+a)/2,l=(t+r)/2;o=[l,i]}if(o)try{i.value.setView(o,a,{animate:!1})}catch(r){}};return{layers:e,findLayerById:t,getAllLayers:n,selectedFeature:o,setSelectedFeature:a,mapInstance:i,setMapInstance:l,navigateToCity:s,visibleLayers:(0,r.EW)((()=>n()))}}),{persist:!0}),N=(0,a.nY)("define",{state:()=>({mapView:{center:[34.271271085914,108.942232774512],zoom:12},googleSatelliteConfig:{url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"© Google",maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"],detectRetina:!0}}),actions:{setMapView(e,t){this.mapView.center=e,this.mapView.zoom=t}}});var T={name:"MapTab",props:{currentCity:{type:String,default:"城市名稱"}},emits:["map-ready"],setup(e,{emit:t}){const n=M(),o=N(),a=(0,k.KR)(null);let i=null,l=null,s={};const c=(0,k.KR)(!1),u=(0,k.KR)(`leaflet-map-${Math.random().toString(36).substr(2,9)}`),d=(0,r.EW)((()=>{if(!e.currentCity)return null;const t=n.getAllLayers(),o=t.find((t=>t.layerName===e.currentCity));return o?{}:null})),m=()=>{if(!a.value)return!1;const e=a.value.getBoundingClientRect();if(0===e.width||0===e.height)return!1;try{return i=R().map(a.value,{center:o.mapView.center,zoom:o.mapView.zoom,zoomControl:!1,attributionControl:!1,dragging:!1,touchZoom:!1,doubleClickZoom:!1,scrollWheelZoom:!1,boxZoom:!1,keyboard:!1}),i.on("zoomend",f),i.on("moveend",p),i.on("click",(function(e){e.originalEvent.target.closest(".leaflet-interactive")||n.setSelectedFeature(null)})),i.getPane("popupPane").style.zIndex=2200,c.value=!0,t("map-ready",i),!0}catch(r){return!1}},f=()=>{if(i){const e=i.getZoom(),n=i.getCenter();o.setMapView([n.lat,n.lng],e),t("update:zoomLevel",e)}},p=()=>{if(i){const e=i.getCenter();o.setMapView([e.lat,e.lng],i.getZoom()),t("update:currentCoords",{lat:e.lat,lng:e.lng})}},y=()=>{if(!i)return;l&&i.removeLayer(l);const e=o.googleSatelliteConfig;l=R().tileLayer(e.url,{attribution:e.attribution,maxZoom:e.maxZoom,subdomains:e.subdomains,detectRetina:e.detectRetina}),i.addLayer(l);const t=a.value,n=t?t.parentElement:null;if(t){const e=["my-map-bg-blank","my-map-bg-black","my-map-bg-transparent"];[t,n].forEach((t=>{t&&t.classList.remove(...e)})),[t,n].forEach((e=>{e&&e.classList.add("my-map-bg-transparent")}))}},v=()=>R().layerGroup([]),g=()=>{if(!i)return;const e=n.getAllLayers();e.forEach((e=>{const t=e.layerId;if(e.coordinates&&e.coordinates.length>=2){if(!s[t]){const n=v(e);n&&(s[t]=n,i.addLayer(n))}}else s[t]&&(i.removeLayer(s[t]),delete s[t])}))},b=()=>{i&&setTimeout((()=>{i.invalidateSize()}),100)},h=()=>{let e=0;const t=20,o=()=>{e>=t||(e++,m()?(y(),g(),setTimeout((()=>{const e=n.findLayerById("Xian");if(e&&e.coordinates){const t=v(e);t&&(s["Xian"]=t,i.addLayer(t))}}),500)):setTimeout(o,100))};o()};let C=null,L=null;const w=()=>{a.value&&window.ResizeObserver&&(C=new ResizeObserver((()=>{L&&clearTimeout(L),L=setTimeout((()=>{b()}),200)})),C.observe(a.value))};return(0,r.sV)((()=>{(0,r.dY)((()=>{h(),w()}))})),(0,r.hi)((()=>{L&&clearTimeout(L),C&&C.disconnect(),i&&(i.remove(),i=null),s={},l=null,c.value=!1})),(0,r.wB)((()=>n.layers),g,{deep:!0}),{mapContainer:a,mapContainerId:u,currentCityInfo:d,invalidateSize:b,defineStore:o}}};const O=(0,u.A)(T,[["render",z]]);var A=O,V={name:"HomeView",components:{MapTab:A},setup(){const e=M(),t=N(),n=t=>e.setMapInstance(t),o=t=>{const n=a.value?.find((e=>e.layerId===t));n&&(console.log("🌍 切換到城市:",n.layerName),i.value=n.layerName),e.navigateToCity(t)},a=(0,r.EW)((()=>e.layers[0].groupLayers)),i=(0,k.KR)("XI'AN");return(0,r.sV)((()=>{o("Xian")})),{setMapInstance:n,navigateToCity:o,cities:a,defineStore:t,currentCity:i}}};const S=(0,u.A)(V,[["render",w]]);var X=S;const _=[{path:"/",name:"Home",component:X}],B=(0,f.aE)({history:(0,f.LA)("/30DayMapChallenge-02_Lines/"),routes:_});var Z=B;n(323);console.log("🎨 樣式文件載入完成");const F=(0,o.Ef)(m),K=(0,a.Ey)();F.use(Z),F.use(K),F.mount("#app"),console.log("🚀 空間分析視覺化平台已啟動"),console.log("📦 Pinia 狀態管理已初始化"),console.log("🗺️ Vue Router 路由系統已就緒"),console.log("🎨 Bootstrap 5 UI 框架已載入"),console.log("🗺️ Leaflet 地圖庫已準備就緒"),console.log("🔤 Font Awesome 圖示庫已載入")}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],r=e[u][2];for(var l=!0,s=0;s<o.length;s++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(l=!1,r<i&&(i=r));if(l){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,i=o[0],l=o[1],s=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(s)var u=s(n)}for(t&&t(o);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunk_30DayMapChallenge_02_Lines"]=self["webpackChunk_30DayMapChallenge_02_Lines"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(7061)}));o=n.O(o)})();
//# sourceMappingURL=app.028cf647.js.map